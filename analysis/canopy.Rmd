---
title: "canopy"
author: "rswaty"
date: "2021-03-23"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---



```{r setup, message=FALSE, warning=FALSE, include=FALSE}
pacman::p_load(tidyverse, ggsci, ggtext, readr, dplyr, DT)
theme_set(theme_bw())
```


## Visualizing the Canopy data

First, the cleaned Canopy data

```{r canopyDT, echo=FALSE, message=FALSE, warning=FALSE}
canopy <- read_csv("data/Canopy_for_R.csv")

datatable(canopy)
```
<br>

Notes:

* Roncal added the "BURN_YEAR" column for ease of plotting, plus cleaned up several small issues (documentation forthcoming)
* Data is a compilation of spreadsheets supplied by Kristina Serbesoff-King (1996-2012) and Charles Oliver (2013-2020)



## Number of observations per year is variable
```{r CanopyObsYear, echo=FALSE, message=FALSE, warning=FALSE}

yearObs <-
canopy %>%
  count(MON_YEAR)

yearObsChart <-
  yearObs %>%
  ggplot(aes(x = MON_YEAR, y = n)) +
  geom_line(size = 1.5) +
  labs(x = "Year",
       y = "Number of rows",
       title = "Number of observations per year",
       caption = "Data from Florida Chapter")  +
  # geom_vline(xintercept = events$yearTreated,
  #            color = "red",
  #            linetype = "longdash") +

  #Adjust the axes
  theme(plot.title = element_text(face="bold", size =14),
        axis.title.x = element_text(face="bold", size = 12),
        axis.title.y = element_text(face="bold", size = 12),
        legend.title = element_text(face="bold", size = 12))


yearObsChart
```


## Some BUs have had more consistent monitoring than others

```{r message=FALSE, warning=FALSE, include=FALSE, results='hide'}
# number of observations per year, by BU

yearObsBU <- canopy %>%
  count (MON_YEAR, BU)

# fix BU data type
yearObsBU %>%
  mutate(BU = as.character(BU))
```


```{r CanopyObsYearBU, echo=FALSE, message=FALSE, warning=FALSE}

yearObsBUChart <-
  yearObsBU %>%
  ggplot(aes(x = MON_YEAR, y = n, group =  BU, color = as.factor(BU))) +
  geom_line(size=1.5, position = position_jitter(width = 0.0001, height = 1.0)) +
  #geom_point(size =  2.0) +

  # My top color palette
  scale_color_simpsons(name = "BU") +
  # labels
  labs(x = "Year",
       y = "Number of rows",
       title = "Number of observations per year colored by BU",
       subtitle = "Lines jittered so that they would not totally overlap",
       caption = "Data from Florida Chapter")  +

  #Adjust the axes
  theme(plot.title = element_text(face="bold", size =14),
        axis.title.x = element_text(face="bold", size = 12),
        axis.title.y = element_text(face="bold", size = 12),
        legend.title = element_text(face="bold", size = 12))


yearObsBUChart

```




